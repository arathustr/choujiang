<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹´ç»ˆç¦åˆ©å¤§æŠ½å¥– - 100%ä¸­å¥–</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            overflow: hidden; /* é˜²æ­¢å‡ºç°æ»šåŠ¨æ¡ */
        }

        /* è½¬ç›˜æŒ‡é’ˆ */
        .arrow-down {
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #FF5252;
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
        }

        /* æ¶ä½œå‰§å…¨å±è¦†ç›–å±‚ */
        #prank-overlay {
            display: none; /* é»˜è®¤éšè— */
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: black;
            z-index: 9999;
            justify-content: center;
            align-items: center;
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        #prank-image {
            width: 100%;
            height: 100%;
            object-fit: contain; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ï¼Œæœ€å¤§åŒ–æ˜¾ç¤º */
        }

        /* éœ‡åŠ¨åŠ¨ç”»ï¼Œå¢åŠ æƒŠå“æ•ˆæœ */
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center">

    <!-- ä¼ªè£…çš„æ ‡é¢˜ -->
    <div class="text-center mb-8 animate-pulse">
        <h1 class="text-3xl md:text-5xl font-bold text-red-600 drop-shadow-md">ğŸ‰ å¹¸è¿å¤§è½¬ç›˜ ğŸ‰</h1>
        <p class="text-gray-700 mt-2 text-sm md:text-base">æ¯æ—¥ä¸€æ¬¡å…è´¹æœºä¼šï¼Œèµ¢å– iPhone 15 Proï¼</p>
    </div>

    <!-- è½¬ç›˜å®¹å™¨ -->
    <div class="relative w-[300px] h-[300px] md:w-[400px] md:h-[400px]">
        <!-- æŒ‡é’ˆ -->
        <div class="arrow-down"></div>
        
        <!-- è½¬ç›˜ Canvas -->
        <canvas id="wheelCanvas" width="400" height="400" class="w-full h-full transition-transform duration-0 ease-out rounded-full shadow-2xl border-4 border-white"></canvas>
        
        <!-- ä¸­å¿ƒæŒ‰é’® -->
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-2 rounded-full shadow-lg z-20">
            <button id="spinBtn" class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-red-500 text-white font-bold text-lg shadow-inner border-4 border-red-600 active:scale-95 transition-transform">
                æŠ½å¥–
            </button>
        </div>
    </div>

    <!-- åº•éƒ¨æç¤ºï¼Œå¢åŠ çœŸå®æ„Ÿ -->
    <div class="mt-10 text-center text-gray-600 text-xs md:text-sm max-w-md px-4">
        <p>å·²æœ‰ <span class="text-red-500 font-bold">3,421</span> äººä¸­å¥–</p>
        <p class="mt-1">æœ¬æ´»åŠ¨æœ€ç»ˆè§£é‡Šæƒå½’ä¸»åŠæ–¹æ‰€æœ‰</p>
    </div>

    <!-- æ¶ä½œå‰§å›¾å±‚ -->
    <div id="prank-overlay">
        <img id="prank-image" src="" alt="Surprise!">
    </div>

    <script>
        // ================= é…ç½®åŒºåŸŸ =================
        
        // 1. å›¾ç‰‡é“¾æ¥ (ä¿æŒä½ ä¹‹å‰çš„ä¿®æ”¹)
        const PRANK_IMAGE_URL = "https://arathustr.github.io/choujiang/main.png"; 
        
        // 2. âš ï¸âš ï¸âš ï¸ éŸ³æ•ˆé“¾æ¥ âš ï¸âš ï¸âš ï¸
        // è¿™é‡Œæ”¾ä¸€ä¸ªå°–å«å£°çš„mp3é“¾æ¥ã€‚ä½ å¯ä»¥å»ç½‘æ˜“äº‘éŸ³ä¹æˆ–ç´ æåº“æ‰¾ä¸€ä¸ªï¼Œä¸Šä¼ åˆ°GitHubè·å–rawé“¾æ¥
        // ä¸‹é¢è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„å¥³æ€§å°–å«å£°ç¤ºä¾‹
        const PRANK_SOUND_URL = "https://www.myinstants.com/media/sounds/scream_1.mp3";
        
        // ===========================================

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const prankOverlay = document.getElementById('prank-overlay');
        const prankImg = document.getElementById('prank-image');

        // é¢„åŠ è½½å›¾ç‰‡
        const preloadImg = new Image();
        preloadImg.src = PRANK_IMAGE_URL;
        prankImg.src = PRANK_IMAGE_URL;

        // é¢„åŠ è½½éŸ³é¢‘
        const screamAudio = new Audio(PRANK_SOUND_URL);
        screamAudio.preload = 'auto'; // å°è¯•è‡ªåŠ¨é¢„åŠ è½½

        const prizes = [
            "iPhone 15", "è°¢è°¢å‚ä¸", "100å…ƒçº¢åŒ…", "å†æ¥å†å‰", 
            "ç¥ç§˜å¤§å¥–", "è¿æ°”çˆ†æ£š", "iPad Air", "ä¸‹æ¬¡ä¸€å®š"
        ];
        const colors = ["#FFD700", "#FFFFFF", "#FFD700", "#FFFFFF", "#FFD700", "#FFFFFF", "#FFD700", "#FFFFFF"];
        
        let startAngle = 0;
        const arc = Math.PI / (prizes.length / 2);
        let spinTimeout = null;
        
        // ç»˜åˆ¶è½¬ç›˜ (ä¿æŒä¸å˜)
        function drawRouletteWheel() {
            const outsideRadius = 190;
            const textRadius = 150;
            const insideRadius = 40;

            ctx.clearRect(0,0,400,400);

            for(let i = 0; i < prizes.length; i++) {
                const angle = startAngle + i * arc;
                
                ctx.fillStyle = colors[i];
                ctx.beginPath();
                ctx.arc(200, 200, outsideRadius, angle, angle + arc, false);
                ctx.arc(200, 200, insideRadius, angle + arc, angle, true);
                ctx.stroke();
                ctx.fill();

                ctx.save();
                ctx.shadowOffsetX = -1;
                ctx.shadowOffsetY = -1;
                ctx.shadowBlur    = 0;
                ctx.fillStyle = "#E53935";
                ctx.translate(200 + Math.cos(angle + arc / 2) * textRadius, 
                              200 + Math.sin(angle + arc / 2) * textRadius);
                ctx.rotate(angle + arc / 2 + Math.PI / 2);
                const text = prizes[i];
                ctx.font = 'bold 18px sans-serif';
                ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
                ctx.restore();
            } 
        }

        // æ—‹è½¬é€»è¾‘
        let spinAngleStart = 10;
        let spinTime = 0;
        let spinTimeTotal = 0;
        
        function rotateWheel() {
            spinTime += 30;
            if(spinTime >= spinTimeTotal) {
                stopRotateWheel();
                return;
            }
            
            const spinAngle = spinAngleStart - (spinAngleStart * (spinTime / spinTimeTotal)); 
            startAngle += (spinAngle * Math.PI / 180);
            drawRouletteWheel();
            spinTimeout = requestAnimationFrame(rotateWheel);
        }

        function stopRotateWheel() {
            cancelAnimationFrame(spinTimeout);
            
            // ç¨å¾®å»¶è¿Ÿ 300 æ¯«ç§’ï¼Œå¿ƒç†é˜²çº¿æœ€ä½çš„æ—¶å€™
            setTimeout(() => {
                triggerPrank();
            }, 300);
        }

        function triggerPrank() {
            // æ’­æ”¾å°–å«éŸ³æ•ˆ (å› ä¸ºä¹‹å‰è§£é”è¿‡ï¼Œè¿™é‡Œä¼šç«‹å³æ’­æ”¾)
            screamAudio.currentTime = 0;
            screamAudio.play().catch(e => console.log("Audio play failed:", e));

            // éœ‡åŠ¨æ•ˆæœ
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 100, 50, 200]); // éœ‡åŠ¨å˜å¾—æ›´å‰§çƒˆä¸€ç‚¹
            }
            
            prankOverlay.style.display = 'flex';
            
            try {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                }
            } catch(e) {
                console.log("Fullscreen not supported or blocked");
            }
        }

        spinBtn.addEventListener('click', () => {
            // â—â—â— å…³é”®æ­¥éª¤ï¼šéŸ³é¢‘è§£é” â—â—â—
            // ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ˜¯â€œç”¨æˆ·äº¤äº’â€ï¼Œæ­¤æ—¶æ’­æ”¾éŸ³é¢‘æ˜¯åˆæ³•çš„ã€‚
            // æˆ‘ä»¬æ’­æ”¾ä¸€ä¸‹ç«‹å³æš‚åœï¼Œè¿™æ ·æµè§ˆå™¨å°±æŠŠè¿™ä¸ªéŸ³é¢‘æ ‡è®°ä¸ºâ€œå·²æˆæƒâ€ï¼Œ
            // ä¹‹ååœ¨ä»£ç é‡Œè‡ªåŠ¨æ’­æ”¾å°±ä¸ä¼šè¢«æ‹¦æˆªäº†ã€‚
            screamAudio.play().then(() => {
                screamAudio.pause();
                screamAudio.currentTime = 0;
            }).catch(error => {
                console.log("Audio autoplay permission waiting...");
            });

            // ç¦ç”¨æŒ‰é’®
            spinBtn.disabled = true;
            spinBtn.classList.add('opacity-50', 'cursor-not-allowed');
            
            spinTime = 0;
            spinTimeTotal = (Math.random() * 1000) + 5000; 
            spinAngleStart = Math.random() * 10 + 20; 
            
            rotateWheel();
        });

        // åˆå§‹åŒ–ç»˜åˆ¶
        drawRouletteWheel();

    </script>
</body>
</html>
